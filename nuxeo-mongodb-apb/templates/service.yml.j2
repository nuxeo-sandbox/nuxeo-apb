apiVersion: v1
kind: Service
metadata:
  name: {{ app_name }}
  namespace: {{ namespace }}
  labels:
    app: {{ app_name }}
    service: {{ app_name }}
    service_class_id: '{{ _apb_service_class_id }}'
    plan_id: '{{ _apb_plan_id }}'
    service_instance_id: '{{ _apb_service_instance_id }}'
    component: {{ component }}
  annotations:
    service.alpha.kubernetes.io/tolerate-unready-endpoints: "true"
{% if serviceAnnotations is defined and (serviceAnnotations | from_yaml) %}
{{ serviceAnnotations | from_yaml | to_nice_yaml(indent=2) | indent(4, true) }}
{% endif %}
spec:
  type: ClusterIP
  clusterIP: None
  ports:
    - name: peer
      port: {{ port }}
  selector:
    app: {{ app_name }}
    service: {{ app_name }}
    component: {{ component }}
