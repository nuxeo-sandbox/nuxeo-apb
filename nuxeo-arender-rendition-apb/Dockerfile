FROM ansibleplaybookbundle/apb-base

LABEL "com.redhat.apb.spec"=\
"LS0tCnZlcnNpb246IDEuMApuYW1lOiBudXhlby1hcmVuZGVyLXJlbmRpdGlvbi1hcGIKZGVzY3Jp\
cHRpb246IEFSZW5kZXIgUmVuZGl0aW9uIGRlcGxveW1lbnQgaW4gT3BlbnNoaWZ0IGZvciBOdXhl\
bwpiaW5kYWJsZTogVHJ1ZQphc3luYzogb3B0aW9uYWwKdGFnczoKICAtIG51eGVvCiAgLSBudXhl\
by1hcmVuZGVyLXJlbmRpdGlvbgptZXRhZGF0YToKICBkaXNwbGF5TmFtZTogQVJlbmRlciBSZW5k\
aXRpb24gZW52aXJvbm1lbnQgZm9yIE51eGVvCiAgaW1hZ2VVcmw6ICJodHRwczovL3d3dy5udXhl\
by5jb20vYXNzZXRzL2ltZ3MvbG9nbzM0MHg2MC5wbmciCiAgbG9uZ0Rlc2NyaXB0aW9uOgogICAg\
VGhpcyBEZXBsb3lzIGFuIEFSZW5kZXIgUmVuZGl0aW9uIGVudmlyb25tZW50IHRoYXQgY2FuIGJl\
IHVzZWQgd2l0aCBOdXhlbwogIGRlcGVuZGVuY2llczogW10KICBwcm92aWRlckRpc3BsYXlOYW1l\
OiAiTnV4ZW8iCnBsYW5zOgogIC0gbmFtZTogYnJpZGdlCiAgICBkZXNjcmlwdGlvbjogQnJpZGdl\
IHRvIGFub3RoZXIgZGVwbG95ZWQgYnJva2VyCiAgICBmcmVlOiB0cnVlCiAgICBtZXRhZGF0YTog\
e30KICAgIHBhcmFtZXRlcnM6CiAgICAtIG5hbWU6IHByb2plY3RfbmFtZQogICAgICB0eXBlOiBz\
dHJpbmcKICAgICAgdGl0bGU6IFByb2plY3QgTmFtZQogICAgICBkZWZhdWx0OiBhcmVuZGVyCiAg\
ICAgIGRpc3BsYXlfZ3JvdXA6IFByb2plY3QgcHJvcGVydGllcwogICAgLSBuYW1lOiBicm9rZXJf\
c2VydmljZV9kbnMKICAgICAgdHlwZTogc3RyaW5nCiAgICAgIHRpdGxlOiBSZW1vdGUgYnJva2Vy\
IEROUwogICAgICBkZWZhdWx0OiBhcmVuZGVyLXBvb2wtMS1yZW5kaXRpb24tYnJva2VyLmludC1h\
cmVuZGVyLXByZXByb2Quc3ZjCiAgICAgIGRpc3BsYXlfZ3JvdXA6IFJlbW90ZSBicm9rZXIKICAg\
IC0gbmFtZTogYnJva2VyX3NlcnZpY2VfcG9ydAogICAgICB0eXBlOiBzdHJpbmcKICAgICAgdGl0\
bGU6IFJlbW90ZSBicm9rZXIgcG9ydAogICAgICBkZWZhdWx0OiAiODc2MSIKICAgICAgZGlzcGxh\
eV9ncm91cDogUmVtb3RlIGJyb2tlcgoKICAtIG5hbWU6IGRlZmF1bHQKICAgIGRlc2NyaXB0aW9u\
OiBEZWZhdWx0IEFSZW5kZXIgUmVuZGl0aW9uIGRlcGxveW1lbnQKICAgIGZyZWU6IHRydWUKICAg\
IG1ldGFkYXRhOiB7fQogICAgcGFyYW1ldGVyczoKICAgIC0gbmFtZTogcHJvamVjdF9uYW1lCiAg\
ICAgIHR5cGU6IHN0cmluZwogICAgICB0aXRsZTogUHJvamVjdCBOYW1lCiAgICAgIGRlZmF1bHQ6\
IGFyZW5kZXIKICAgICAgZGlzcGxheV9ncm91cDogUHJvamVjdCBwcm9wZXJ0aWVzCgogICAgLSBu\
YW1lOiBhcmVuZGVyX3JlbmRpdGlvbl9pbWFnZV9yZWdpc3RyeQogICAgICB0eXBlOiBzdHJpbmcK\
ICAgICAgdGl0bGU6IEFSZW5kZXIgcmVuZGl0aW9uIGltYWdlCiAgICAgIGRlZmF1bHQ6IGRvY2tl\
ci1yZWdpc3RyeS5kZWZhdWx0LnN2Yzo1MDAwL2NvbW1vbi1pbmZyYQogICAgICBkaXNwbGF5X2dy\
b3VwOiBDb250YWluZXIgSW1hZ2UKICAgIC0gbmFtZTogYXJlbmRlcl9yZW5kaXRpb25faW1hZ2Vf\
dmVyc2lvbgogICAgICB0eXBlOiBzdHJpbmcKICAgICAgdGl0bGU6IEFSZW5kZXIgcmVuZGl0aW9u\
IGltYWdlCiAgICAgIGRlZmF1bHQ6ICI0LjAuNi5OWDIuMCIKICAgICAgZGlzcGxheV9ncm91cDog\
Q29udGFpbmVyIEltYWdlCiAgICAtIG5hbWU6IGFyZW5kZXJfcmVuZGl0aW9uX2ltYWdlX3B1bGxf\
ZXhpc3Rpbmdfc2VjcmV0CiAgICAgIHR5cGU6IHN0cmluZwogICAgICB0aXRsZTogTmFtZSBvZiBz\
ZWNyZXQgdG8gdXNlIHRvIHB1bGwgaW1hZ2UgKExlYXZlIGVtcHR5IGlmIHlvdXQgd2FudCB0byB1\
c2UgdXNlci9wYXNzd29yZCkKICAgICAgZGlzcGxheV9ncm91cDogQ29udGFpbmVyIEltYWdlCiAg\
ICAtIG5hbWU6IGFyZW5kZXJfcmVuZGl0aW9uX2ltYWdlX3B1bGxfdXNlcm5hbWUKICAgICAgdHlw\
ZTogc3RyaW5nCiAgICAgIHRpdGxlOiBVc2VybmFtZSB0byB1c2UgdG8gcHVsbCB0aGUgRG9ja2Vy\
IGltYWdlCiAgICAgIGRpc3BsYXlfZ3JvdXA6IENvbnRhaW5lciBJbWFnZQogICAgLSBuYW1lOiBh\
cmVuZGVyX3JlbmRpdGlvbl9pbWFnZV9wdWxsX3Bhc3N3b3JkCiAgICAgIHR5cGU6IHN0cmluZwog\
ICAgICB0aXRsZTogUGFzc3dvcmQgdG8gdXNlIHRvIHB1bGwgdGhlIERvY2tlciBpbWFnZQogICAg\
ICBkaXNwbGF5X3R5cGU6IHBhc3N3b3JkCiAgICAgIGRpc3BsYXlfZ3JvdXA6IENvbnRhaW5lciBJ\
bWFnZQoKICAgIC0gbmFtZTogYXJlbmRlcl9hdXRvc2NhbGluZ19taW4KICAgICAgZGVmYXVsdDog\
MQogICAgICB0eXBlOiBudW1iZXIKICAgICAgdGl0bGU6IEF1dG9zY2FsaW5nIE1pbmltdW0gcmVw\
bGljYXMKICAgICAgZGlzcGxheV9ncm91cDogQXV0b3NjYWxpbmcKICAgIC0gbmFtZTogYXJlbmRl\
cl9hdXRvc2NhbGluZ19tYXgKICAgICAgZGVmYXVsdDogMTAKICAgICAgdHlwZTogbnVtYmVyCiAg\
ICAgIHRpdGxlOiBBdXRvc2NhbGluZyBNYXhpbXVtIHJlcGxpY2FzCiAgICAgIGRpc3BsYXlfZ3Jv\
dXA6IEF1dG9zY2FsaW5nCiAgICAtIG5hbWU6IGFyZW5kZXJfYXV0b3NjYWxpbmdfdGFyZ2V0Q1BV\
CiAgICAgIGRlZmF1bHQ6IDgwCiAgICAgIHR5cGU6IG51bWJlcgogICAgICB0aXRsZTogQXV0b3Nj\
YWxpbmcgVGFyZ2V0IENQVSBVc2FnZSBwZXJjZW50YWdlCiAgICAgIGRpc3BsYXlfZ3JvdXA6IEF1\
dG9zY2FsaW5nCgogICAgLSBuYW1lOiBhcmVuZGVyX2Jyb2tlcl9yZXNvdXJjZXMKICAgICAgZGVm\
YXVsdDogJ3sibGltaXRzIjogeyJjcHUiOiAiMSIsIm1lbW9yeSI6ICIxLjVHaSJ9LCJyZXF1ZXN0\
cyI6IHsiY3B1IjogIjEiLCJtZW1vcnkiOiAiMUdpIn19JwogICAgICB0eXBlOiBzdHJpbmcKICAg\
ICAgdGl0bGU6IEJyb2tlciBQb2QgcmVzb3VyY2UgcmVxdWVzdHMgYW5kIGxpbWl0cwogICAgICBk\
aXNwbGF5X3R5cGU6IHRleHRhcmVhCiAgICAgIGRpc3BsYXlfZ3JvdXA6IENvbnRhaW5lciBTcGVj\
cwogICAgLSBuYW1lOiBhcmVuZGVyX2NvbnZlcnRlcl9yZXNvdXJjZXMKICAgICAgZGVmYXVsdDog\
J3sibGltaXRzIjogeyJjcHUiOiAiMS41IiwibWVtb3J5IjogIjZHaSJ9LCJyZXF1ZXN0cyI6IHsi\
Y3B1IjogIjEiLCJtZW1vcnkiOiAiNEdpIn19JwogICAgICB0eXBlOiBzdHJpbmcKICAgICAgdGl0\
bGU6IENvbnZlcnRlciBQb2QgcmVzb3VyY2UgcmVxdWVzdHMgYW5kIGxpbWl0cwogICAgICBkaXNw\
bGF5X3R5cGU6IHRleHRhcmVhCiAgICAgIGRpc3BsYXlfZ3JvdXA6IENvbnRhaW5lciBTcGVjcwog\
ICAgLSBuYW1lOiBhcmVuZGVyX3BkZmJveF9yZXNvdXJjZXMKICAgICAgZGVmYXVsdDogJ3sibGlt\
aXRzIjogeyJjcHUiOiAiMSIsIm1lbW9yeSI6ICIxLjVHaSJ9LCJyZXF1ZXN0cyI6IHsiY3B1Ijog\
IjEiLCJtZW1vcnkiOiAiMUdpIn19JwogICAgICB0eXBlOiBzdHJpbmcKICAgICAgdGl0bGU6IFBE\
RkJveCBQb2QgcmVzb3VyY2UgcmVxdWVzdHMgYW5kIGxpbWl0cwogICAgICBkaXNwbGF5X3R5cGU6\
IHRleHRhcmVhCiAgICAgIGRpc3BsYXlfZ3JvdXA6IENvbnRhaW5lciBTcGVjcwogICAgLSBuYW1l\
OiBhcmVuZGVyX2puaV9yZXNvdXJjZXMKICAgICAgZGVmYXVsdDogJ3sibGltaXRzIjogeyJjcHUi\
OiAiMiIsIm1lbW9yeSI6ICI2R2kifSwicmVxdWVzdHMiOiB7ImNwdSI6ICIyIiwibWVtb3J5Ijog\
IjRHaSJ9fScKICAgICAgdHlwZTogc3RyaW5nCiAgICAgIHRpdGxlOiBKTkkgUG9kIHJlc291cmNl\
IHJlcXVlc3RzIGFuZCBsaW1pdHMKICAgICAgZGlzcGxheV90eXBlOiB0ZXh0YXJlYQogICAgICBk\
aXNwbGF5X2dyb3VwOiBDb250YWluZXIgU3BlY3MKICAgIC0gbmFtZTogYXJlbmRlcl9kZnNfcmVz\
b3VyY2VzCiAgICAgIGRlZmF1bHQ6ICd7ImxpbWl0cyI6IHsiY3B1IjogIjEiLCJtZW1vcnkiOiAi\
MS41R2kifSwicmVxdWVzdHMiOiB7ImNwdSI6ICIxIiwibWVtb3J5IjogIjFHaSJ9fScKICAgICAg\
dHlwZTogc3RyaW5nCiAgICAgIHRpdGxlOiBERlMgUG9kIHJlc291cmNlIHJlcXVlc3RzIGFuZCBs\
aW1pdHMKICAgICAgZGlzcGxheV90eXBlOiB0ZXh0YXJlYQogICAgICBkaXNwbGF5X2dyb3VwOiBD\
b250YWluZXIgU3BlY3MKICAgIC0gbmFtZTogcGVyc2lzdGVudFZvbHVtZV9zdG9yYWdlQ2xhc3MK\
ICAgICAgZGVmYXVsdDogJ3NoYXJlZCcKICAgICAgdHlwZTogc3RyaW5nCiAgICAgIHRpdGxlOiBT\
dG9yYWdlIGNsYXNzZSBuYW1lIChtdXN0IGJlIGNhcGFibGUgb2YgUldYKQogICAgICBkaXNwbGF5\
X2dyb3VwOiBDb250YWluZXIgU3BlY3MKCiAgICAtIG5hbWU6IGFyZW5kZXJfZGVidWdfcG9kCiAg\
ICAgIGRlZmF1bHQ6IGZhbHNlCiAgICAgIHR5cGU6IGJvb2xlYW4KICAgICAgZGlzcGxheV90eXBl\
OiBjaGVja2JveAogICAgICB0aXRsZTogRGVwbG95IGEgZGVidWcgcG9kCiAgICAgIGRpc3BsYXlf\
Z3JvdXA6IE90aGVycwoKICAgIC0gbmFtZTogYXJlbmRlcl9yZW5kaXRpb25faW1hZ2VtYWdpY2tf\
b3B0aW9ucwogICAgICBkZWZhdWx0OiAnLXF1YWxpdHksMTAwLC1kZW5zaXR5LDcyeDcyLC11bml0\
cyxQaXhlbHNQZXJJbmNoLC1hdXRvLW9yaWVudCwrcmVwYWdlJwogICAgICB0eXBlOiBzdHJpbmcK\
ICAgICAgdGl0bGU6IE9wdGlvbnMgcGFzc2VkIHRvIEltYWdlIE1hZ2ljayBmb3IgY29udmVyc2lv\
bnMKICAgICAgZGlzcGxheV9ncm91cDogQVJlbmRlciBjb25maWd1cmF0aW9uCgogICAgLSBuYW1l\
OiBhcmVuZGVyX3JlbmRpdGlvbl9jb252ZXJzaW9uX3RpbWVvdXQKICAgICAgZGVmYXVsdDogMjQw\
CiAgICAgIHR5cGU6IG51bWJlcgogICAgICB0aXRsZTogVGltZW91dCBmb3IgY29udmVyc2lvbgog\
ICAgICBkaXNwbGF5X2dyb3VwOiBBUmVuZGVyIGNvbmZpZ3VyYXRpb24KCiAgICAtIG5hbWU6IGFy\
ZW5kZXJfcmVuZGl0aW9uX21vbml0b3JpbmdfZW5hYmxlZAogICAgICBkZWZhdWx0OiB0cnVlCiAg\
ICAgIHR5cGU6IGJvb2xlYW4KICAgICAgZGlzcGxheV90eXBlOiBjaGVja2JveAogICAgICB0aXRs\
ZTogRW5hYmxlIE1vbml0b3Jpbmcgc3RhY2sKICAgICAgZGlzcGxheV9ncm91cDogTW9uaXRvcmlu\
ZwoKICAgIC0gbmFtZTogYXJlbmRlcl9yZW5kaXRpb25fbW9uaXRvcmluZ19lc19zZXJ2aWNlCiAg\
ICAgIGRlZmF1bHQ6IGFyZW5kZXItbW9uaXRvci1lbGFzdGljc2VhcmNoCiAgICAgIHR5cGU6IHN0\
cmluZwogICAgICB0aXRsZTogTmFtZSBvZiB0aGUgRVMgc2VydmljZSBpbnN0YW5jZQogICAgICBk\
aXNwbGF5X2dyb3VwOiBNb25pdG9yaW5nCgogICAgLSBuYW1lOiBhcmVuZGVyX3JlbmRpdGlvbl9t\
b25pdG9yaW5nX2tpYmFuYV9zZXJ2aWNlCiAgICAgIGRlZmF1bHQ6IGFyZW5kZXItbW9uaXRvci1r\
aWJhbmEKICAgICAgdHlwZTogc3RyaW5nCiAgICAgIHRpdGxlOiBOYW1lIG9mIHRoZSBLaWJhbmEg\
c2VydmljZSBpbnN0YW5jZQogICAgICBkaXNwbGF5X2dyb3VwOiBNb25pdG9yaW5nCgo="



ADD playbooks /opt/apb/actions

# Add our role into the ansible roles dir
ADD . /opt/ansible/roles/nuxeo-arender-apb/
ADD . /opt/ansible/roles/nuxeo-arender-rendition-apb/

RUN chmod -R g=u /opt/{ansible,apb}

USER apb